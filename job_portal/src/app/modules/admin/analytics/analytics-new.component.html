<main class="analytics-dashboard">
  <div class="container">
    <!-- Page Header -->
    <div class="header-section">
      <h1>📊 Analytics Dashboard</h1>
      <p>Real-time insights from your job portal database</p>
      <button (click)="loadAnalyticsData()" class="refresh-btn" [disabled]="loading">
        <span *ngIf="!loading">🔄 Refresh Data</span>
        <span *ngIf="loading">⏳ Loading...</span>
      </button>
    </div>

    <!-- Loading State -->
    <div *ngIf="loading" class="loading-state">
      <div class="loading-spinner"></div>
      <span>Loading real analytics data...</span>
    </div>

    <!-- Error State -->
    <div *ngIf="error" class="error-state">
      <h3>❌ Error Loading Analytics</h3>
      <p>{{ error }}</p>
      <button (click)="loadAnalyticsData()" class="retry-btn">Try Again</button>
    </div>

    <!-- Analytics Content -->
    <div *ngIf="!loading && !error && analyticsData" class="analytics-content">
      
      <!-- Stats Cards Section -->
      <div class="stats-section">
        <h2>📈 Key Metrics</h2>
        <div class="stats-grid">
          <div class="stat-card users-card">
            <div class="stat-icon">👥</div>
            <div class="stat-info">
              <div class="stat-value">{{ analyticsData.totalUsers | number }}</div>
              <div class="stat-label">Total Users</div>
              <div class="stat-growth" [class.positive]="analyticsData.userGrowth >= 0" [class.negative]="analyticsData.userGrowth < 0">
                {{ analyticsData.userGrowth >= 0 ? '+' : '' }}{{ analyticsData.userGrowth }}% from last month
              </div>
            </div>
          </div>
          
          <div class="stat-card jobs-card">
            <div class="stat-icon">💼</div>
            <div class="stat-info">
              <div class="stat-value">{{ analyticsData.activeJobs | number }}</div>
              <div class="stat-label">Active Jobs</div>
              <div class="stat-growth" [class.positive]="analyticsData.jobGrowth >= 0" [class.negative]="analyticsData.jobGrowth < 0">
                {{ analyticsData.jobGrowth >= 0 ? '+' : '' }}{{ analyticsData.jobGrowth }}% from last month
              </div>
            </div>
          </div>
          
          <div class="stat-card applications-card">
            <div class="stat-icon">📝</div>
            <div class="stat-info">
              <div class="stat-value">{{ analyticsData.totalApplications | number }}</div>
              <div class="stat-label">Total Applications</div>
              <div class="stat-growth" [class.positive]="analyticsData.applicationGrowth >= 0" [class.negative]="analyticsData.applicationGrowth < 0">
                {{ analyticsData.applicationGrowth >= 0 ? '+' : '' }}{{ analyticsData.applicationGrowth }}% from last month
              </div>
            </div>
          </div>
          
          <div class="stat-card visits-card">
            <div class="stat-icon">👁️</div>
            <div class="stat-info">
              <div class="stat-value">{{ analyticsData.conversionFunnel.visits | number }}</div>
              <div class="stat-label">Job Views</div>
              <div class="stat-growth positive">Real database views</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Charts Section -->
      <div class="charts-section">
        <h2>📊 Visual Analytics</h2>
        <div class="charts-grid">
          
          <!-- Monthly Trends Chart -->
          <div class="chart-card">
            <div class="chart-header">
              <h3>📈 Monthly Trends</h3>
              <div class="chart-legend">
                <span class="legend-item users">Users</span>
                <span class="legend-item jobs">Jobs</span>
                <span class="legend-item applications">Applications</span>
              </div>
            </div>
            <div class="chart-container">
              <canvas #monthlyTrendsChart class="chart-canvas"></canvas>
            </div>
          </div>
          
          <!-- Job Categories Chart -->
          <div class="chart-card">
            <div class="chart-header">
              <h3>📂 Job Categories</h3>
              <p>Distribution by category</p>
            </div>
            <div class="chart-container">
              <canvas #categoriesChart class="chart-canvas"></canvas>
            </div>
          </div>
          
          <!-- Application Status Chart -->
          <div class="chart-card">
            <div class="chart-header">
              <h3>📋 Application Status</h3>
              <p>Current application breakdown</p>
            </div>
            <div class="chart-container">
              <canvas #statusChart class="chart-canvas"></canvas>
            </div>
          </div>
          
          <!-- Conversion Funnel Chart -->
          <div class="chart-card">
            <div class="chart-header">
              <h3>🎯 Conversion Funnel</h3>
              <p>From views to hires</p>
            </div>
            <div class="chart-container">
              <canvas #funnelChart class="chart-canvas"></canvas>
            </div>
          </div>
          
        </div>
      </div>

      <!-- Data Summary Section -->
      <div class="summary-section">
        <h2>📋 Data Summary</h2>
        <div class="summary-grid">
          <div class="summary-card">
            <h4>👥 User Overview</h4>
            <ul>
              <li><strong>{{ analyticsData.totalUsers }}</strong> total users registered</li>
              <li><strong>{{ analyticsData.activeUsers }}</strong> active users</li>
              <li><strong>{{ analyticsData.userGrowth >= 0 ? '+' : '' }}{{ analyticsData.userGrowth }}%</strong> growth this month</li>
            </ul>
          </div>
          
          <div class="summary-card">
            <h4>💼 Job Statistics</h4>
            <ul>
              <li><strong>{{ analyticsData.activeJobs }}</strong> active job postings</li>
              <li><strong>{{ analyticsData.jobCategories.length }}</strong> different categories</li>
              <li><strong>{{ analyticsData.conversionFunnel.visits }}</strong> total job views</li>
            </ul>
          </div>
          
          <div class="summary-card">
            <h4>📝 Application Metrics</h4>
            <ul>
              <li><strong>{{ analyticsData.totalApplications }}</strong> total applications</li>
              <li><strong>{{ analyticsData.conversionFunnel.interviews }}</strong> interviews scheduled</li>
              <li><strong>{{ analyticsData.conversionFunnel.hires }}</strong> successful hires</li>
            </ul>
          </div>
        </div>
      </div>

    </div>
  </div>
</main>
